digraph eelpond {

bgcolor=black;

rankdir=LR;

edge [ 	color="#ff00ff";
	penwidth=4 ]

node [
	shape=box;
	fillcolor=white;
	bgcolor=white;
]


subgraph cluster_trimmomatic {
	style=filled;
	color=white;
	label="Trimmomatic";
	t_input_1 [
		label = "Input FASTQ file (R1/first of pair)" ]
        t_input_2 [
		label = "Input FASTQ file (R2/second of pair)" ]
	t_output_1 [
		label = "fastq_out_r1_paired (fastqsanger)" ]
	t_output_2 [
		label = "fastq_out_r1_unpaired (fastqsanger)" ]
	t_output_3 [
		label = "fastq_out_r2_paired (fastqsanger)" ]
	t_output_4 [
		label = "fastq_out_r2_unpaired (fastqsanger)" ]
	t_output_5 [
		label = "fastq_out (fastqsanger)" ]
	}

subgraph cluster_input_1 {
	style=filled;
	color=white;
	label="Input dataset";
	fontcolor="#ff00ff";
	w_input_1 [ label = "output" ]
}

subgraph cluster_input_2 {
	style=filled;
	color=white;
	label="Input dataset";
	fontcolor="#ff00ff";
	w_input_2 [ label = "output" ]
}

w_input_1->t_input_1;
w_input_2->t_input_2;

subgraph cluster_fbq1 {
	style=filled;
	color=white;
	label="Filter by quality";
	fbq1_input1 [ label="Library to filter" ]
	fbq1_output1 [ label="output" ]
}

t_output_1->fbq1_input1;

subgraph cluster_cd1 {
	style=filled;
	label="Concatenate datasets";
	color=white;
	cd1_input1 [ label="Concatenate dataset" ]
	cd1_input2 [ label="Dataset 1 > Select" ]
	cd1_output1 [ label="out_file1" ]
}

t_output_2->cd1_input1;
t_output_4->cd1_input2;

subgraph cluster_fbq2 {
	style=filled;
	color=white;
	label="Filter by quality";
	fbq2_input1 [ label="Library to filter" ]
	fbq2_output1 [ label="output" ]
}

t_output_3->fbq2_input1;

subgraph cluster_fqi {
	style=filled;
	color=white;
	label="FASTQ interlacer";
	fqi_input1 [ label="Left-hand mates" ]
	fqi_input2 [ label="Right-hand mates" ]
	fqi_output1 [ label="outfile_pairs" ]
	fqi_output2 [ label="outfile_singles" ]
}

fbq1_output1 -> fqi_input1;
fbq2_output1 -> fqi_input2;

subgraph cluster_fbq3 {
	style=filled;
	color=white;
	label="Filter by quality";
	fbq3_input1 [ label="Library to filter" ]
	fbq3_output1 [ label="output" ]
}

cd1_output1->fbq3_input1;

subgraph cluster_cd2 {
	style=filled;
	color=white;
	label="Concatenate datasets";
	cd2_input1 [ label="Concatenate dataset" ]
	cd2_input2 [ label="Dataset 1 > Select" ]
	cd2_output1 [ label="out_file1" ]
}

fqi_output2->cd2_input1;
fbq3_output1->cd2_input2;

subgraph cluster_outputs {
	style=filled;
	color=white;
	label="Output datasets";
	fontcolor="#ff00ff"
	output1 [ label="interlaced FASTQ reads" ]
	output2 [ label="orphaned FASTQ reads" ]	
}

fqi_output1->output1;
cd2_output1->output2;

}
